<div id="container">
	<div class="row" id:"profile-row">
		<div class="large-3 small-12 columns" id="profile-picture">
			<div class="row">
				<div class="large-12 columns" id="profile-image">
					<%= image_tag @user.avatar_url(:profile)%>
				</div>
				<div class="large-12 columns" id="profile-content">
					<% if current_user == @user %>
					  <%= link_to "Edit Profile", edit_user_path(@user) %> | <%= link_to "Delete Account", user_path(@user), data: { confirm: 'Are you sure?' }, method: :delete%>
					  <p>Joined on: <%=@user.created_at%></p>
					<% end %>
				</div>
			</div>
		</div>

		<div class="large-1 columns"></div>

		<div class="large-8 small-12 columns" id="profile-section">
    	<h4>Hosted Events</h4>
	  	<ul>
		    <% @user.hosted_events.each do |event| %>
			    <% if event.not_passed %>
				    <li>
				      <%= link_to event.title, user_event_path(@user, event) %>
				    </li>
			    <% end %>
		    <% end %>
	  	</ul>

	  	<h4>Joined Events</h4>
			<ul>
			  <% @user.commitments.each do |commitment| %>
				  <% if commitment.event.not_passed %>
					  <li>
					    <%= link_to commitment.event.title, user_event_path(commitment.event.host, commitment.event) %>
					  </li>
				  <% end %>
			  <% end %>
			</ul>
    </div>

  </div>

  <br/>

	<div class="row" id:"friend-row">
		<div class="large-3 small-12 columns" id="friend-section">
					<% if @user.incoming_friendships != [] %>
					  <b>Friend Requests</b><br>
					  <% @user.incoming_friendships.each do |friendship| %>
					    <%= friendship.user.first_name %> <%= friendship.user.last_name %><br> 
					    <%= link_to "Accept", friendships_path(friend_id: friendship.user.id),class:"small-caps", method: :post %> <%= link_to "Reject", friendship_path(friendship), data: { confirm: 'Are you sure?' },class:"small-caps", method: :delete %>
					  <% end %>	
					  <hr>
					<% end %>

					<b>Friends</b><br>
						<% @user.friendships.sort{|x,y| x.friend.first_name <=> y.friend.first_name}.each do |friendship| %>
							<% if friendship.confirm %>
						    		<%= link_to friendship.friend.first_name + " " + friendship.friend.last_name, user_path(friendship.friend) %><br>
						    		<%= link_to "remove", friendship_path(friendship, friend_id: friendship.friend.id), data: { confirm: 'Are you sure?' }, class:"small-caps", id:"remove-friend", method: :delete %><br>
							<% end %>
						<% end %>
		</div>

		<div class="large-1 columns"></div>

		<div class="large-8 small-12 columns" id="tab-section">
			<dl class="tabs" data-tab>
			  <dd class="active"><a href="#panel1" id="left-tab">Ratings</a></dd>
			  <dd><a href="#panel2" id="center-tab">Genres</a></dd>
			  <dd><a href="#panel3" id="center-tab">Actors</a></dd>
			  <dd><a href="#panel4" id="right-tab">Directors</a></dd>
			</dl>
			<div class="tabs-content">
				<div class="content active" id="panel1">
					<div id="chart4"></div>
				</div>
				<div class="content" id="panel2">
					<div id="chart"></div>
				</div>
				<div class="content" id="panel3">
					<div id="chart2"></div>	
				</div>
				<div class="content" id="panel4">
					<div id="chart3"></div>
				</div>
			</div>
		</div>
	</div>

	<br />

	<div class="row" id:"wishlist-row">
		<div class="large-3 small-12 columns" id="review-section">
			<div class="row">
				<div class="large-12 columns">
					<b>Recent Reviews</b><br/><br/>
					<div id="review-list">
						<%= render :partial => "ratings" %>
					</div>
				</div>
				<div class="large-12 columns">
				</div>
			</div>
		</div>
		<div class="large-1 columns"></div>
		<div class="large-8 small-12 columns" id="wish-section">
			<b>Wishlist</b>
				<ul id="featured1 inline-list" data-orbit>
					<% count = 0 %>
				  <li>
					<% @user.movie_interests.each do |movie| %>
						<% count += 1 %>
						<% if count % 10 == 0 %>
							<% return true %>
						<% else %>
						<div>
							<% sleep(0.2) %>
							<img src="<%= Movie.find_movie(movie.rt_id).poster %>" style="float:left; padding-right:5px;" />
							<% if current_user.id == @user.id %>
							  <div id="slider-caption">
									<%= link_to "remove", user_movie_interest_path(@user,movie), data: { confirm: 'Are you sure?' }, method: :delete %>
    						</div>
						</div>
								<% if count % 3 == 0 %>
								</li>
								<li>
								<% end %>
							<% end %>
						<% end %> 
				 	<% end %>
				  </li>
				</ul>		
		</div>
	</div>
</div>

<script>
	var chart = c3.generate({
		bindto: '#chart',
		data: {
			columns: gon.genres,
			type: 'donut',
			hide: true,
      hide: ['Other']
    },
    donut: {
      title: "Favourite Genres",
      width: 80
    }
  });

	var chart2 = c3.generate({
		bindto: '#chart2',
		data: {
			columns: gon.actors,
			type: 'donut',
			hide: true,
      hide: ['Other']
    },
    donut: {
      title: "Favourite Actors",
      width: 80
    }
  });

	var chart3 = c3.generate({
		bindto: '#chart3',
		data: {
			columns: gon.directors,
			type: 'donut',
			hide: true,
      hide: ['Other']
    },
    donut: {
      title: "Favourite Directors",
      width: 80
    }
  });

	var chart4 = c3.generate({
		bindto: '#chart4',
    data: {
      columns: [
      gon.average
      ],
      type: 'gauge',
    },
    color: {
      pattern: ['#FF0000', '#F97600', '#F6C600', '#60B044'], // the four color levels for the percentage values.
      threshold: {
//            unit: 'value', // percentage is default
//            max: 200, // 100 is default
values: [30, 60, 75, 100]
}
},
});

</script>
